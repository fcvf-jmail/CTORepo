# Конфигурация Swagger/Swashbuckle

## Обзор

Проект настроен с полной документацией API через Swagger/Swashbuckle с использованием XML-комментариев на русском языке.

## Доступ к документации

- **Swagger UI**: `http://localhost:5000/swagger`
- **OpenAPI JSON**: `http://localhost:5000/swagger/v1/swagger.json`

Swagger UI доступен только в режиме Development.

## Метаданные API

- **Название**: Web API для управления статьями
- **Версия**: v1
- **Описание**: Полное описание на русском языке с разделами:
  - Основные возможности
  - Особенности работы с тегами
  - Особенности сортировки

## Реализованные функции

### 1. XML-комментарии

XML-документация включена для:
- **WebApi.Application** - DTOs с подробными описаниями полей, примерами и требованиями валидации
- **WebApi.Presentation** - Endpoints с описанием операций

Конфигурация в .csproj файлах:
```xml
<GenerateDocumentationFile>true</GenerateDocumentationFile>
<NoWarn>$(NoWarn);1591</NoWarn>
```

### 2. Документация DTO

Все DTO имеют:
- XML-комментарии на русском (`summary`, `remarks`)
- Примеры значений для каждого поля (`example`)
- Описание требований валидации
- Примеры схем на уровне объекта

#### Документированные DTOs:
- `CreateArticleRequest` - создание статьи
- `UpdateArticleRequest` - обновление статьи
- `ArticleResponse` - ответ со статьей
- `SectionResponse` - ответ с разделом

### 3. Документация эндпоинтов

Все эндпоинты имеют:
- Краткое описание (`WithSummary`)
- Подробное описание (`WithDescription`)
- Описание особенностей работы (сортировка, дедупликация)

#### Документированные эндпоинты:

**Articles:**
- `GET /api/articles/{id}` - Получить статью по идентификатору
- `POST /api/articles` - Создать новую статью
- `PUT /api/articles/{id}` - Обновить существующую статью
- `DELETE /api/articles/{id}` - Удалить статью

**Sections:**
- `GET /api/sections` - Получить все разделы
- `GET /api/sections/{sectionId}/articles` - Получить статьи раздела

### 4. Коды ответов

Для каждого эндпоинта описаны коды ответов на русском:
- `200` - Успешное выполнение запроса
- `201` - Ресурс успешно создан
- `204` - Успешное выполнение, без тела ответа
- `400` - Неверный формат запроса или нарушение правил валидации
- `404` - Запрашиваемый ресурс не найден
- `500` - Внутренняя ошибка сервера

### 5. Примеры схем

Реализован `SchemaExamplesFilter`, который добавляет примеры для всех DTO:

```csharp
// Пример для CreateArticleRequest
{
  "title": "Введение в Clean Architecture",
  "content": "Clean Architecture - это архитектурный подход...",
  "tags": ["Архитектура", "Разработка", "Паттерны"]
}
```

### 6. Сортировка тегов

Реализован `TagSortingFilter`, который автоматически сортирует теги в документации Swagger по алфавиту.

### 7. Фильтры Swagger

Созданы пользовательские фильтры:

#### TagSortingFilter
- Сортирует теги в документации по алфавиту

#### ResponseExamplesFilter
- Добавляет описания кодов ответов на русском для всех операций
- Обеспечивает единообразие описаний

#### SchemaExamplesFilter
- Добавляет примеры для схем DTO
- Примеры на русском языке с реалистичными данными

## Структура файлов

```
src/Presentation/WebApi.Presentation/
├── Swagger/
│   ├── TagSortingFilter.cs          # Фильтр сортировки тегов
│   ├── ResponseExamplesFilter.cs    # Фильтр описаний ответов
│   └── SchemaExamplesFilter.cs      # Фильтр примеров схем
├── Program.cs                        # Конфигурация Swagger
└── WebApi.Presentation.csproj       # XML-документация включена

src/Application/WebApi.Application/
├── DTOs/
│   ├── CreateArticleRequest.cs      # С XML-комментариями и примерами
│   ├── UpdateArticleRequest.cs      # С XML-комментариями и примерами
│   ├── ArticleResponse.cs           # С XML-комментариями и примерами
│   └── SectionResponse.cs           # С XML-комментариями и примерами
└── WebApi.Application.csproj        # XML-документация включена
```

## Особенности документации

### Язык
Все комментарии, описания и примеры на русском языке.

### Требования полей
В документации указаны:
- Обязательность полей
- Минимальная и максимальная длина
- Формат данных
- Особенности обработки (дедупликация, сортировка)

### Сортировка
Документировано:
- Автоматическая сортировка тегов по алфавиту (без учета регистра)
- Сортировка разделов по количеству статей (убывание)
- Сортировка статей по дате обновления/создания (убывание)

### Примеры
Все схемы содержат:
- Примеры на уровне объекта
- Примеры для каждого поля
- Реалистичные данные

## Проверка

Для проверки работы Swagger:

1. Запустить приложение:
```bash
dotnet run --project src/Presentation/WebApi.Presentation/WebApi.Presentation.csproj
```

2. Открыть браузер:
```
http://localhost:5000/swagger
```

3. Проверить:
   - ✅ Swagger UI доступен
   - ✅ Название и описание на русском
   - ✅ Все эндпоинты отображаются
   - ✅ XML-комментарии видны
   - ✅ Примеры схем присутствуют
   - ✅ Коды ответов описаны на русском
   - ✅ Теги отсортированы по алфавиту
   - ✅ Описания включают требования по полям и сортировке
